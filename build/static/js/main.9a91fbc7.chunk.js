(this["webpackJsonpgoit-react-hw-07-hooks-phonebook"]=this["webpackJsonpgoit-react-hw-07-hooks-phonebook"]||[]).push([[4],{15:function(e,t,n){e.exports={AppBar:"Contacts_AppBar__3KpEM",navigation:"Contacts_navigation__mU0L8",link:"Contacts_link__3D0y5",activeLink:"Contacts_activeLink__1rSp_",list:"Contacts_list__3B76I"}},17:function(e,t,n){"use strict";n.r(t),n.d(t,"fetchContacts",(function(){return u})),n.d(t,"addContact",(function(){return l})),n.d(t,"deleteContact",(function(){return d}));var r=n(7),c=n.n(r),a=n(18),i=n(16),s=n.n(i),o=n(5),u=Object(o.b)("contacts/fetchContacts",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,s.a.get("/contacts");case 4:return a=e.sent,i=a.data,e.abrupt("return",i);case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()),l=Object(o.b)("contacts/addContact",function(){var e=Object(a.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/contacts",t);case 2:return n=e.sent,r=n.data,e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),d=Object(o.b)("contacts/deleteContact",function(){var e=Object(a.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.delete("/contacts/".concat(t));case 2:return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},33:function(e,t,n){e.exports={text:"UserMenu_text__1ClS9",btn:"UserMenu_btn__14UxZ"}},43:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r,c=n(4),a=n(5),i=n(17),s=Object(a.c)({name:"contacts",initialState:{items:[],filter:"",isLoading:!1,error:null},reducers:{changeFilters:function(e,t){e.filter=t.payload}},extraReducers:(r={},Object(c.a)(r,i.fetchContacts.pending,(function(e,t){e.isLoading=!0})),Object(c.a)(r,i.fetchContacts.fulfilled,(function(e,t){e.isLoading=!1,e.items=t.payload})),Object(c.a)(r,i.fetchContacts.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload})),Object(c.a)(r,i.addContact.pending,(function(e,t){e.isLoading=!0})),Object(c.a)(r,i.addContact.fulfilled,(function(e,t){e.isLoading=!1,e.items.unshift(t.payload)})),Object(c.a)(r,i.addContact.rejected,(function(e,t){e.error=t.payload})),Object(c.a)(r,i.deleteContact.pending,(function(e,t){e.isLoading=!0})),Object(c.a)(r,i.deleteContact.fulfilled,(function(e,t){e.isLoading=!1,e.items=e.items.filter((function(e){return e.id!==t.payload}))})),Object(c.a)(r,i.deleteContact.rejected,(function(e,t){e.error=t.payload})),r)}),o=s.actions.changeFilters;t.b=s.reducer},53:function(e,t,n){},6:function(e,t,n){"use strict";n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return j})),n.d(t,"d",(function(){return f}));var r=n(7),c=n.n(r),a=n(18),i=n(16),s=n.n(i),o=n(5);s.a.defaults.baseURL="https://connections-api.herokuapp.com";var u=function(e){s.a.defaults.headers.common.Authorization="Bearer ".concat(e)},l=function(){s.a.defaults.headers.common.Authorization=""},d=Object(o.b)("user/signup",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,s.a.post("/users/signup",t);case 4:return a=e.sent,i=a.data,console.log(i),e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),b=Object(o.b)("user/logIn",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,s.a.post("/users/login",t);case 4:return a=e.sent,i=a.data,u(i.token),e.abrupt("return",i);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,n){return e.apply(this,arguments)}}()),j=Object(o.b)("user/logOut",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.rejectWithValue,e.prev=1,e.next=4,s.a.post("/users/logout");case 4:l(),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",r(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()),f=Object(o.b)("user/refresh",function(){var e=Object(a.a)(c.a.mark((function e(t,n){var r,a,i,o,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getState,a=n.rejectWithValue,i=r(),null!==(o=i.auth.token)){e.next=5;break}return e.abrupt("return",a({status:null,statusText:"Token not found"}));case 5:return u(o),e.prev=6,e.next=9,s.a.get("/users/current");case 9:return l=e.sent,d=l.data,e.abrupt("return",d);case 14:return e.prev=14,e.t0=e.catch(6),e.abrupt("return",a(e.t0));case 17:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t,n){return e.apply(this,arguments)}}()),p={signUp:d,logIn:b,logOut:j,refresh:f};t.a=p},85:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(27),i=n.n(a),s=(n(53),n(20)),o=n(3),u=n(12),l={getIsLoggedIn:function(e){return e.auth.isLoggedIn},getUserName:function(e){return e.auth.user.name},getIsfetchingCurrentUser:function(e){return e.auth.isFetchingCurrentUser}},d=n(6),b=n(22),j=n(29),f=n(1),p=["children","redirectTo"],h=function(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/login":n,c=Object(j.a)(e,p),a=Object(u.c)(l.getIsLoggedIn);return Object(f.jsx)(o.b,Object(b.a)(Object(b.a)({},c),{},{children:a?t:Object(f.jsx)(o.a,{to:r})}))},O=["children","redirectTo","restricted"],g=function(e){var t=e.children,n=e.redirectTo,r=void 0===n?"/":n,c=e.restricted,a=void 0!==c&&c,i=Object(j.a)(e,O),s=Object(u.c)(l.getIsLoggedIn)&&a;return Object(f.jsx)(o.b,Object(b.a)(Object(b.a)({},i),{},{children:s?Object(f.jsx)(o.a,{to:r}):t}))},x=n(33),v=n.n(x),m=function(){var e=Object(u.b)(),t=Object(u.c)(l.getUserName);return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("p",{className:v.a.text,children:["Hello, ",t]}),Object(f.jsx)("button",{onClick:function(){e(d.a.logOut())},className:v.a.btn,children:"Log out"})]})},k=n(15),L=n.n(k),C=Object(r.lazy)((function(){return n.e(0).then(n.bind(null,96))})),y=Object(r.lazy)((function(){return n.e(2).then(n.bind(null,97))})),w=Object(r.lazy)((function(){return n.e(3).then(n.bind(null,98))})),_=Object(r.lazy)((function(){return n.e(1).then(n.bind(null,99))})),I=function(){var e=Object(u.b)(),t=Object(u.c)(l.getIsLoggedIn),n=Object(u.c)(l.getIsfetchingCurrentUser);return console.log(n),Object(r.useEffect)((function(){e(d.a.refresh())}),[e]),!n&&Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)("div",{className:L.a.AppBar,children:[Object(f.jsx)("ul",{className:"".concat(L.a.navigation," ").concat(L.a.list),children:t?Object(f.jsx)("li",{children:Object(f.jsx)(s.b,{exact:!0,to:"/contacts",className:L.a.link,activeClassName:L.a.activeLink,children:"Phonebook"})}):Object(f.jsx)("li",{children:Object(f.jsx)(s.b,{exact:!0,to:"/",className:L.a.link,activeClassName:L.a.activeLink,children:"Home"})})}),t?Object(f.jsx)(m,{}):Object(f.jsxs)("ul",{className:L.a.list,children:[Object(f.jsx)("li",{children:Object(f.jsx)(s.b,{exact:!0,to:"/register",className:L.a.link,activeClassName:L.a.activeLink,children:"Registration"})}),Object(f.jsx)("li",{children:Object(f.jsx)(s.b,{exact:!0,to:"/login",className:L.a.link,activeClassName:L.a.activeLink,children:"Login"})})]})]}),Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("h1",{children:"Loading...test"}),children:Object(f.jsxs)(o.d,{children:[Object(f.jsx)(g,{exact:!0,redirectTo:"/contacts",restricted:!0,path:"/",children:Object(f.jsx)(C,{})}),Object(f.jsx)(h,{exact:!0,redirectTo:"/login",path:"/contacts",children:Object(f.jsx)(y,{})}),Object(f.jsx)(g,{exact:!0,redirectTo:"/contacts",restricted:!0,path:"/register",children:Object(f.jsx)(w,{})}),Object(f.jsx)(g,{exact:!0,redirectTo:"/contacts",restricted:!0,path:"/login",children:Object(f.jsx)(_,{})})]})})]})};var N,U=function(){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("meta",{name:"viewport",content:"initial-scale=1, width=device-width"}),Object(f.jsx)(I,{})]})},F=n(48),T=n(5),z=n(46),S=n.n(z),A=n(19),B=n(43),V=n(4),W=Object(T.c)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrentUser:!1,error:null},extraReducers:(N={},Object(V.a)(N,d.e.pending,(function(e,t){e.isLoading=!0})),Object(V.a)(N,d.e.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload,e.isLoggedIn=!0,e.isLoading=!1})),Object(V.a)(N,d.e.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload})),Object(V.a)(N,d.b.pending,(function(e,t){e.isLoading=!0})),Object(V.a)(N,d.b.fulfilled,(function(e,t){e.user=t.payload.user,e.token=t.payload.token,e.isLoggedIn=!0,e.isLoading=!1})),Object(V.a)(N,d.b.rejected,(function(e,t){e.isLoading=!1})),Object(V.a)(N,d.c.pending,(function(e,t){e.isLoading=!0})),Object(V.a)(N,d.c.fulfilled,(function(e,t){e.user.name=null,e.user.email=null,e.token=null,e.isLoggedIn=!1,e.isLoading=!1})),Object(V.a)(N,d.d.pending,(function(e,t){e.isFetchingCurrentUser=!0})),Object(V.a)(N,d.d.fulfilled,(function(e,t){e.user=t.payload,e.isLoggedIn=!0,e.isFetchingCurrentUser=!1})),Object(V.a)(N,d.d.rejected,(function(e,t){e.isFetchingCurrentUser=!1,e.isLoggedIn=!1,e.error=t.payload})),N)}).reducer,M=Object(F.a)(Object(T.d)({serializableCheck:{ignoredActions:[A.a,A.f,A.b,A.c,A.d,A.e]}})),R={key:"token",storage:S.a,whitelist:["token"]},E=Object(A.g)(R,W),H=Object(T.a)({reducer:{auth:E,contacts:B.b},devtools:!0,middleware:M}),J={store:H,persistor:Object(A.h)(H)},D=n(47);i.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(u.a,{store:J.store,children:Object(f.jsx)(D.a,{loading:null,persistor:J.persistor,children:Object(f.jsx)(s.a,{children:Object(f.jsx)(U,{})})})})}),document.getElementById("root"))}},[[85,5,6]]]);
//# sourceMappingURL=main.9a91fbc7.chunk.js.map